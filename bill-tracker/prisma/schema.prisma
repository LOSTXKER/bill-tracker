// Bill Tracker & Mini-ERP System
// Database schema for Anajak T-Shirt & Meelike-th

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

// =============================================================================
// Core Business Entities
// =============================================================================

model Company {
  id        String   @id @default(cuid())
  name      String   // "Anajak T-Shirt", "Meelike-th"
  code      String   @unique // "ANJ", "MLK"
  taxId     String?  // ‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏†‡∏≤‡∏©‡∏µ
  address   String?
  phone     String?
  logoUrl   String?

  // LINE Bot Configuration
  lineChannelSecret      String? // LINE Bot Channel Secret
  lineChannelAccessToken String? // LINE Bot Channel Access Token
  lineGroupId            String? // LINE Group ID (auto-filled by bot)

  // AI Configuration
  aiConfig Json? // AI preferences and settings

  // Relations
  expenses          Expense[]
  incomes           Income[]
  users             CompanyAccess[]
  vendors           Vendor[]
  customers         Customer[]
  budgets           Budget[]
  integrations      Integration[]
  recurringExpenses RecurringExpense[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([code])
}

// =============================================================================
// User Management with RBAC
// =============================================================================

model User {
  id          String    @id @default(cuid())
  email       String    @unique
  name        String
  password    String    // hashed with bcrypt
  role        UserRole  @default(STAFF)
  isActive    Boolean   @default(true)
  lastLoginAt DateTime?
  avatarUrl   String?

  // Relations
  companies CompanyAccess[]
  expenses  Expense[]       @relation("ExpenseCreator")
  incomes   Income[]        @relation("IncomeCreator")
  auditLogs AuditLog[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([email])
}

enum UserRole {
  ADMIN      // ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î - ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏î‡πâ
  ACCOUNTANT // ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ - ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ expense/income ‡πÑ‡∏î‡πâ
  STAFF      // ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ - ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÑ‡∏î‡πâ
  VIEWER     // ‡∏î‡∏π‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß
}

model CompanyAccess {
  id          String   @id @default(cuid())
  userId      String
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  companyId   String
  company     Company  @relation(fields: [companyId], references: [id], onDelete: Cascade)
  
  // Custom Permission System
  isOwner     Boolean  @default(false) // OWNER flag - ‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á
  permissions Json     @default("[]")  // Custom permissions array: ["expenses:*", "incomes:read", ...]

  createdAt   DateTime @default(now())
  updatedAt   DateTime @default(now()) @updatedAt

  @@unique([userId, companyId])
  @@index([userId])
  @@index([companyId])
}

// =============================================================================
// Vendors (‡∏ú‡∏π‡πâ‡∏Ç‡∏≤‡∏¢/‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤)
// =============================================================================

model Vendor {
  id        String  @id @default(cuid())
  companyId String
  company   Company @relation(fields: [companyId], references: [id], onDelete: Cascade)
  name      String
  taxId     String? // ‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏†‡∏≤‡∏©‡∏µ‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏Ç‡∏≤‡∏¢
  address   String?
  phone     String?
  email     String?
  notes     String?

  expenses Expense[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([companyId])
  @@index([taxId])
  @@index([name])
}

// =============================================================================
// Customers (‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤)
// =============================================================================

model Customer {
  id              String   @id @default(cuid())
  companyId       String
  company         Company  @relation(fields: [companyId], references: [id], onDelete: Cascade)
  name            String
  taxId           String?  // ‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏†‡∏≤‡∏©‡∏µ‡∏Ç‡∏≠‡∏á‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤
  address         String?
  phone           String?
  email           String?
  creditLimit     Decimal? @db.Decimal(12, 2)
  paymentTermDays Int      @default(0) // ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï
  notes           String?

  incomes Income[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([companyId])
  @@index([taxId])
  @@index([name])
}

// =============================================================================
// Expense (‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢) - Enhanced
// =============================================================================

model Expense {
  id        String  @id @default(cuid())
  companyId String
  company   Company @relation(fields: [companyId], references: [id], onDelete: Cascade)

  // Vendor Information
  vendorId   String?
  vendor     Vendor? @relation(fields: [vendorId], references: [id])
  vendorName String? // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏£‡∏ì‡∏µ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å vendor ‡∏à‡∏≤‡∏Å master
  vendorTaxId String?

  // Financial Data
  amount    Decimal  @db.Decimal(12, 2) // ‡∏¢‡∏≠‡∏î‡πÄ‡∏ï‡πá‡∏°‡∏Å‡πà‡∏≠‡∏ô VAT
  vatRate   Int      @default(7)        // 7% ‡∏´‡∏£‡∏∑‡∏≠ 0%
  vatAmount Decimal? @db.Decimal(12, 2)

  // WHT (‡πÄ‡∏£‡∏≤‡∏´‡∏±‡∏Å‡πÄ‡∏Ç‡∏≤)
  isWht     Boolean  @default(false)
  whtRate   Decimal? @db.Decimal(5, 2) // 1, 2, 3, 5, 10
  whtAmount Decimal? @db.Decimal(12, 2)
  whtType   WhtType?                   // ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏î‡πâ
  netPaid   Decimal  @db.Decimal(12, 2) // Amount + VAT - WHT

  // Document Details
  description   String?
  category      ExpenseCategory?
  invoiceNumber String?              // ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡∏Å‡∏≥‡∏Å‡∏±‡∏ö‡∏†‡∏≤‡∏©‡∏µ
  referenceNo   String?              // ‡πÄ‡∏•‡∏Ç‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á transaction
  paymentMethod PaymentMethod        @default(BANK_TRANSFER)

  // Evidence Files (Supabase Storage URLs)
  slipUrl       String? // ‡∏£‡∏π‡∏õ‡∏™‡∏•‡∏¥‡∏õ‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô
  taxInvoiceUrl String? // ‡∏£‡∏π‡∏õ‡πÉ‡∏ö‡∏Å‡∏≥‡∏Å‡∏±‡∏ö‡∏†‡∏≤‡∏©‡∏µ
  whtCertUrl    String? // ‡∏£‡∏π‡∏õ‡πÉ‡∏ö 50 ‡∏ó‡∏ß‡∏¥

  // Dates
  billDate DateTime  @default(now()) // ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏á‡∏¥‡∏ô
  dueDate  DateTime?                 // ‡∏ß‡∏±‡∏ô‡∏Ñ‡∏£‡∏ö‡∏Å‡∏≥‡∏´‡∏ô‡∏î (‡∏Å‡∏£‡∏ì‡∏µ‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï)

  // Status & Workflow
  status ExpenseDocStatus @default(PENDING_PHYSICAL)
  notes  String?          @db.Text

  // Approval (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏™‡∏π‡∏á)
  approvedBy String?
  approvedAt DateTime?

  // Tracking
  createdBy String
  creator   User     @relation("ExpenseCreator", fields: [createdBy], references: [id])
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([companyId, billDate])
  @@index([status])
  @@index([category])
  @@index([vendorId])
  @@index([createdAt])
}

enum ExpenseCategory {
  MATERIAL   // ‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö
  UTILITY    // ‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏π‡∏õ‡πÇ‡∏†‡∏Ñ
  MARKETING  // ‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î
  SALARY     // ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
  FREELANCE  // ‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á‡∏ü‡∏£‡∏µ‡πÅ‡∏•‡∏ô‡∏ã‡πå
  TRANSPORT  // ‡∏Ñ‡πà‡∏≤‡∏Ç‡∏ô‡∏™‡πà‡∏á
  RENT       // ‡∏Ñ‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤
  OFFICE     // ‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô
  OTHER      // ‡∏≠‡∏∑‡πà‡∏ô‡πÜ
}

enum ExpenseDocStatus {
  WAITING_FOR_DOC  // üü† ‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß ‡πÅ‡∏ï‡πà‡∏£‡πâ‡∏≤‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à‡∏°‡∏≤
  PENDING_PHYSICAL // üî¥ ‡πÑ‡∏î‡πâ‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß ‡πÅ‡∏ï‡πà‡∏ï‡∏±‡∏ß‡∏à‡∏£‡∏¥‡∏á‡∏¢‡∏±‡∏á‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà‡∏ï‡∏±‡∏ß
  READY_TO_SEND    // üü° ‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡πÉ‡∏™‡πà‡∏ã‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß ‡∏£‡∏≠‡∏™‡πà‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ
  SENT_TO_ACCOUNT  // üü¢ ‡∏™‡πà‡∏á‡πÉ‡∏´‡πâ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß
}

// =============================================================================
// Income (‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö) - Enhanced
// =============================================================================

model Income {
  id        String  @id @default(cuid())
  companyId String
  company   Company @relation(fields: [companyId], references: [id], onDelete: Cascade)

  // Customer Information
  customerId   String?
  customer     Customer? @relation(fields: [customerId], references: [id])
  customerName String?
  customerTaxId String?

  // Financial Data
  amount    Decimal  @db.Decimal(12, 2) // ‡∏¢‡∏≠‡∏î‡πÄ‡∏ï‡πá‡∏°‡∏Å‡πà‡∏≠‡∏ô VAT
  vatRate   Int      @default(0)
  vatAmount Decimal? @db.Decimal(12, 2)

  // WHT (‡πÄ‡∏Ç‡∏≤‡∏´‡∏±‡∏Å‡πÄ‡∏£‡∏≤)
  isWhtDeducted Boolean  @default(false)
  whtRate       Decimal? @db.Decimal(5, 2)
  whtAmount     Decimal? @db.Decimal(12, 2)
  whtType       WhtType?
  netReceived   Decimal  @db.Decimal(12, 2)

  // Document Details
  source        String? // ‡πÅ‡∏´‡∏•‡πà‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏≤
  invoiceNumber String? // ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡∏Å‡∏≥‡∏Å‡∏±‡∏ö‡∏†‡∏≤‡∏©‡∏µ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏≠‡∏≠‡∏Å‡πÉ‡∏´‡πâ
  referenceNo   String?
  paymentMethod PaymentMethod @default(BANK_TRANSFER)

  // Evidence Files (Supabase Storage URLs)
  customerSlipUrl String? // ‡∏™‡∏•‡∏¥‡∏õ‡∏ó‡∏µ‡πà‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÇ‡∏≠‡∏ô‡∏°‡∏≤
  myBillCopyUrl   String? // ‡∏™‡∏≥‡πÄ‡∏ô‡∏≤‡∏ö‡∏¥‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÉ‡∏´‡πâ
  whtCertUrl      String? // ‡πÉ‡∏ö 50 ‡∏ó‡∏ß‡∏¥ ‡∏ó‡∏µ‡πà‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡πâ‡∏°‡∏≤

  // Dates
  receiveDate DateTime @default(now())

  // Status & Workflow
  status IncomeDocStatus @default(PENDING_COPY_SEND)
  notes  String?         @db.Text

  // Job Order (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Phase 5 - Anajak)
  jobOrderId String?

  // Tracking
  createdBy String
  creator   User     @relation("IncomeCreator", fields: [createdBy], references: [id])
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([companyId, receiveDate])
  @@index([status])
  @@index([customerId])
  @@index([createdAt])
}

enum IncomeDocStatus {
  NO_DOC_REQUIRED   // ‚ö™ ‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£
  WAITING_ISSUE     // üü† ‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß ‡πÅ‡∏ï‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ö‡∏¥‡∏•
  WAITING_WHT_CERT  // üü† ‡∏≠‡∏≠‡∏Å‡∏ö‡∏¥‡∏•‡πÅ‡∏•‡πâ‡∏ß ‡πÅ‡∏ï‡πà‡∏£‡∏≠‡πÉ‡∏ö 50 ‡∏ó‡∏ß‡∏¥
  PENDING_COPY_SEND // üî¥ ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏Ñ‡∏£‡∏ö ‡∏£‡∏≠‡∏™‡πà‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ
  SENT_COPY         // üü¢ ‡∏™‡πà‡∏á‡∏õ‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏ô‡∏≤‡πÉ‡∏´‡πâ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÅ‡∏•‡πâ‡∏ß
}

// =============================================================================
// Shared Enums
// =============================================================================

enum PaymentMethod {
  CASH          // ‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î
  BANK_TRANSFER // ‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô
  CREDIT_CARD   // ‡∏ö‡∏±‡∏ï‡∏£‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï
  PROMPTPAY     // ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏û‡∏¢‡πå
  CHEQUE        // ‡πÄ‡∏ä‡πá‡∏Ñ
}

enum WhtType {
  SERVICE_3      // ‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ 3%
  PROFESSIONAL_5 // ‡∏Ñ‡πà‡∏≤‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡∏ä‡∏≤‡∏ä‡∏µ‡∏û 5%
  TRANSPORT_1    // ‡∏Ñ‡πà‡∏≤‡∏Ç‡∏ô‡∏™‡πà‡∏á 1%
  RENT_5         // ‡∏Ñ‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤ 5%
  ADVERTISING_2  // ‡∏Ñ‡πà‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ 2%
  OTHER          // ‡∏≠‡∏∑‡πà‡∏ô‡πÜ
}

// =============================================================================
// Recurring Expenses (‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏õ‡∏£‡∏∞‡∏à‡∏≥)
// =============================================================================

model RecurringExpense {
  id        String  @id @default(cuid())
  companyId String
  company   Company @relation(fields: [companyId], references: [id], onDelete: Cascade)

  name         String         // ‡πÄ‡∏ä‡πà‡∏ô "‡∏Ñ‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤‡πÇ‡∏Å‡∏î‡∏±‡∏á", "‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô"
  templateData Json           // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á Expense
  frequency    RecurrenceFreq
  amount       Decimal        @db.Decimal(12, 2)

  nextDueDate   DateTime
  lastCreatedAt DateTime?

  isActive Boolean @default(true)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([companyId, nextDueDate])
  @@index([isActive])
}

enum RecurrenceFreq {
  MONTHLY
  QUARTERLY
  YEARLY
}

// =============================================================================
// Budget Management
// =============================================================================

model Budget {
  id        String  @id @default(cuid())
  companyId String
  company   Company @relation(fields: [companyId], references: [id], onDelete: Cascade)

  category ExpenseCategory
  amount   Decimal         @db.Decimal(12, 2) // ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡πÑ‡∏ß‡πâ
  period   BudgetPeriod

  startDate DateTime
  endDate   DateTime

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([companyId, startDate])
  @@index([category])
}

enum BudgetPeriod {
  MONTHLY
  QUARTERLY
  YEARLY
}

// =============================================================================
// Integration Configuration
// =============================================================================

model Integration {
  id        String  @id @default(cuid())
  companyId String
  company   Company @relation(fields: [companyId], references: [id], onDelete: Cascade)

  type           IntegrationType
  name           String          // ‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
  config         Json            // API keys, endpoints, etc.
  isActive       Boolean         @default(true)
  lastSyncAt     DateTime?
  lastSyncStatus String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([companyId, type])
}

enum IntegrationType {
  ACCOUNTING_SOFTWARE // PEAK, Express
  BANK_STATEMENT      // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£
  PAYMENT_GATEWAY     // PromptPay
  LINE_NOTIFY
  GOOGLE_DRIVE        // Backup
}

// =============================================================================
// Audit Log (‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á)
// =============================================================================

model AuditLog {
  id          String      @id @default(cuid())
  userId      String
  user        User        @relation(fields: [userId], references: [id])
  companyId   String?     // ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö filter logs ‡∏ï‡∏≤‡∏° company)

  action      AuditAction
  entityType  String      // "Expense", "Income", etc.
  entityId    String
  changes     Json?       // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á (before/after)
  description String?     // ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏™‡∏±‡πâ‡∏ô‡πÜ ‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á
  ipAddress   String?
  userAgent   String?

  createdAt   DateTime    @default(now())

  @@index([companyId, createdAt])
  @@index([entityType, entityId])
  @@index([userId, createdAt])
  @@index([createdAt])
}

enum AuditAction {
  CREATE
  UPDATE
  DELETE
  STATUS_CHANGE
  APPROVE
  EXPORT
}
